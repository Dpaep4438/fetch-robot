!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("fetchRobot",[],r):"object"==typeof exports?exports.fetchRobot=r():e.fetchRobot=r()}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var t={};return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s="./src/index.js")}({"./node_modules/querystringify/index.js":function(e,r,t){"use strict";function n(e){return decodeURIComponent(e.replace(/\+/g," "))}function o(e){for(var r,t=/([^=?&]+)=?([^&]*)/g,o={};r=t.exec(e);o[n(r[1])]=n(r[2]));return o}function i(e,r){r=r||"";var t=[];"string"!=typeof r&&(r="?");for(var n in e)a.call(e,n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.length?r+t.join("&"):""}var a=Object.prototype.hasOwnProperty;r.stringify=i,r.parse=o},"./node_modules/requires-port/index.js":function(e,r,t){"use strict";e.exports=function(e,r){if(r=r.split(":")[0],!(e=+e))return!1;switch(r){case"http":case"ws":return 80!==e;case"https":case"wss":return 443!==e;case"ftp":return 21!==e;case"gopher":return 70!==e;case"file":return!1}return 0!==e}},"./node_modules/url-parse/index.js":function(e,r,t){"use strict";(function(r){function n(e){e=e||r.location||{};var t,n={},o=void 0===e?"undefined":c(e);if("blob:"===e.protocol)n=new a(unescape(e.pathname),{});else if("string"===o){n=new a(e,{});for(t in w)delete n[t]}else if("object"===o){for(t in e)t in w||(n[t]=e[t]);void 0===n.slashes&&(n.slashes=h.test(e.href))}return n}function o(e){var r=d.exec(e);return{protocol:r[1]?r[1].toLowerCase():"",slashes:!!r[2],rest:r[3]}}function i(e,r){for(var t=(r||"/").split("/").slice(0,-1).concat(e.split("/")),n=t.length,o=t[n-1],i=!1,a=0;n--;)"."===t[n]?t.splice(n,1):".."===t[n]?(t.splice(n,1),a++):a&&(0===n&&(i=!0),t.splice(n,1),a--);return i&&t.unshift(""),"."!==o&&".."!==o||t.push(""),t.join("/")}function a(e,r,t){if(!(this instanceof a))return new a(e,r,t);var u,s,d,h,w,y,m=p.slice(),v=void 0===r?"undefined":c(r),E=this,S=0;for("object"!==v&&"string"!==v&&(t=r,r=null),t&&"function"!=typeof t&&(t=l.parse),r=n(r),s=o(e||""),u=!s.protocol&&!s.slashes,E.slashes=s.slashes||u&&r.slashes,E.protocol=s.protocol||r.protocol||"",e=s.rest,s.slashes||(m[2]=[/(.*)/,"pathname"]);S<m.length;S++)h=m[S],d=h[0],y=h[1],d!==d?E[y]=e:"string"==typeof d?~(w=e.indexOf(d))&&("number"==typeof h[2]?(E[y]=e.slice(0,w),e=e.slice(w+h[2])):(E[y]=e.slice(w),e=e.slice(0,w))):(w=d.exec(e))&&(E[y]=w[1],e=e.slice(0,w.index)),E[y]=E[y]||(u&&h[3]?r[y]||"":""),h[4]&&(E[y]=E[y].toLowerCase());t&&(E.query=t(E.query)),u&&r.slashes&&"/"!==E.pathname.charAt(0)&&(""!==E.pathname||""!==r.pathname)&&(E.pathname=i(E.pathname,r.pathname)),f(E.port,E.protocol)||(E.host=E.hostname,E.port=""),E.username=E.password="",E.auth&&(h=E.auth.split(":"),E.username=h[0]||"",E.password=h[1]||""),E.origin=E.protocol&&E.host&&"file:"!==E.protocol?E.protocol+"//"+E.host:"null",E.href=E.toString()}function u(e,r,t){var n=this;switch(e){case"query":"string"==typeof r&&r.length&&(r=(t||l.parse)(r)),n[e]=r;break;case"port":n[e]=r,f(r,n.protocol)?r&&(n.host=n.hostname+":"+r):(n.host=n.hostname,n[e]="");break;case"hostname":n[e]=r,n.port&&(r+=":"+n.port),n.host=r;break;case"host":n[e]=r,/:\d+$/.test(r)?(r=r.split(":"),n.port=r.pop(),n.hostname=r.join(":")):(n.hostname=r,n.port="");break;case"protocol":n.protocol=r.toLowerCase(),n.slashes=!t;break;case"pathname":n.pathname=r.length&&"/"!==r.charAt(0)?"/"+r:r;break;default:n[e]=r}for(var o=0;o<p.length;o++){var i=p[o];i[4]&&(n[i[1]]=n[i[1]].toLowerCase())}return n.origin=n.protocol&&n.host&&"file:"!==n.protocol?n.protocol+"//"+n.host:"null",n.href=n.toString(),n}function s(e){e&&"function"==typeof e||(e=l.stringify);var r,t=this,n=t.protocol;n&&":"!==n.charAt(n.length-1)&&(n+=":");var o=n+(t.slashes?"//":"");return t.username&&(o+=t.username,t.password&&(o+=":"+t.password),o+="@"),o+=t.host+t.pathname,r="object"===c(t.query)?e(t.query):t.query,r&&(o+="?"!==r.charAt(0)?"?"+r:r),t.hash&&(o+=t.hash),o}var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f=t("./node_modules/requires-port/index.js"),l=t("./node_modules/querystringify/index.js"),d=/^([a-z][a-z0-9.+-]*:)?(\/\/)?([\S\s]*)/i,h=/^[A-Za-z][A-Za-z0-9+-.]*:\/\//,p=[["#","hash"],["?","query"],["/","pathname"],["@","auth",1],[NaN,"host",void 0,1,1],[/:(\d+)$/,"port",void 0,1],[NaN,"hostname",void 0,1,1]],w={hash:1,query:1};a.prototype={set:u,toString:s},a.extractProtocol=o,a.location=n,a.qs=l,e.exports=a}).call(r,t("./node_modules/webpack/buildin/global.js"))},"./node_modules/webpack/buildin/global.js":function(e,r){var t,n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(t=window)}e.exports=t},"./src/index.js":function(e,r,t){"use strict";function n(e){try{if(!e)return!1;if(window.Promise&&e instanceof window.Promise)return!0;if(window.Window&&e instanceof window.Window)return!1;if(window.constructor&&e instanceof window.constructor)return!1;if(ar){var r=ar.call(e);if("[object Window]"===r||"[object global]"===r||"[object DOMWindow]"===r)return!1}if("function"==typeof e.then)return!0}catch(e){return!1}return!1}function o(e){if(-1===sr.indexOf(e)){sr.push(e),setTimeout(function(){throw e},1);for(var r=0;r<ur.length;r++)ur[r](e)}}function i(e){return ur.push(e),{cancel:function(){ur.splice(ur.indexOf(e),1)}}}function a(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function u(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function s(e){var r=e.location;if(!r)throw new Error("Can not read window location");var t=r.protocol;if(!t)throw new Error("Can not read window protocol");if(t===lr.FILE_PROTOCOL)return"file://";var n=r.host;if(!n)throw new Error("Can not read window host");return t+"//"+n}function c(e){e=e||window;var r=s(e);return r&&e.mockDomain&&0===e.mockDomain.indexOf(lr.MOCK_PROTOCOL)?e.mockDomain:r}function f(e){try{if(!e.location.href)return!0;if("about:blank"===e.location.href)return!0}catch(e){}return!1}function l(e){try{var r=Object.getOwnPropertyDescriptor(e,"location");if(r&&!1===r.enumerable)return!1}catch(e){}try{if(f(e))return!0;if(s(e)===s(window))return!0}catch(e){}return!1}function d(e){if(!l(e))return!1;try{if(f(e))return!0;if(c(window)===c(e))return!0}catch(e){}return!1}function h(e){if(e)try{if(e.parent&&e.parent!==e)return e.parent}catch(e){return}}function p(e){if(e&&!h(e))try{return e.opener}catch(e){return}}function w(e){var r=[];try{for(;e.parent!==e;)r.push(e.parent),e=e.parent}catch(e){}return r}function y(e,r){if(!e||!r)return!1;var t=h(r);return t?t===e:-1!==w(r).indexOf(e)}function m(e){var r=[],t=void 0;try{t=e.frames}catch(r){t=e}var n=void 0;try{n=t.length}catch(e){}if(0===n)return r;if(n){for(var o=0;o<n;o++){var i=void 0;try{i=t[o]}catch(e){continue}r.push(i)}return r}for(var a=0;a<100;a++){var u=void 0;try{u=t[a]}catch(e){return r}if(!u)return r;r.push(u)}return r}function v(e){for(var r=[],t=m(e),n=Array.isArray(t),o=0,t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if(o=t.next(),o.done)break;i=o.value}var a=i;r.push(a);for(var u=v(a),s=Array.isArray(u),c=0,u=s?u:u[Symbol.iterator]();;){var f;if(s){if(c>=u.length)break;f=u[c++]}else{if(c=u.next(),c.done)break;f=c.value}var l=f;r.push(l)}}return r}function E(e){if(e){try{if(e.top)return e.top}catch(e){}if(h(e)===e)return e;try{if(y(window,e)&&window.top)return window.top}catch(e){}try{if(y(e,window)&&window.top)return window.top}catch(e){}for(var r=v(e),t=Array.isArray(r),n=0,r=t?r:r[Symbol.iterator]();;){var o;if(t){if(n>=r.length)break;o=r[n++]}else{if(n=r.next(),n.done)break;o=n.value}var i=o;try{if(i.top)return i.top}catch(e){}if(h(i)===i)return i}}}function S(e){if(!e.contentWindow)return!0;if(!e.parentNode)return!0;var r=e.ownerDocument;return!(!r||!r.body||r.body.contains(e))}function g(e){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];try{if(e===window)return!1}catch(e){return!0}try{if(!e)return!0}catch(e){return!0}try{if(e.closed)return!0}catch(e){return!e||"Call was rejected by callee.\r\n"!==e.message}if(r&&d(e))try{if(e.mockclosed)return!0}catch(e){}try{if(!e.parent||!e.top)return!0}catch(e){}try{var t=dr.indexOf(e);if(-1!==t){var n=hr[t];if(n&&S(n))return!0}}catch(e){}return!1}function _(e){e=e||window;var r=p(e);if(r)return r;var t=h(e);return t||void 0}function b(e,r){var t=_(r);if(t)return t===e;if(r===e)return!1;if(E(r)===r)return!1;for(var n=m(e),o=Array.isArray(n),i=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if(i=n.next(),i.done)break;a=i.value}if(a===r)return!0}return!1}function O(){return Boolean(p(window))}function A(){return Boolean(h(window))}function P(e,r){if("string"==typeof e){if("string"==typeof r)return e===lr.WILDCARD||r===e;if(u(r))return!1;if(Array.isArray(r))return!1}return u(e)?u(r)?e.toString()===r.toString():!Array.isArray(r)&&Boolean(r.match(e)):!!Array.isArray(e)&&(Array.isArray(r)?JSON.stringify(e)===JSON.stringify(r):!u(r)&&e.some(function(e){return P(e,r)}))}function T(e){var r=void 0;return e.match(/^(https?|mock|file):\/\//)?(r=e,r=r.split("/").slice(0,3).join("/")):c()}function R(e){try{if(e&&e.self===e)return!0}catch(e){}return!1}function k(){if(!window.WeakMap)return!1;if(!window.Object.freeze)return!1;try{var e=new window.WeakMap,r={};return window.Object.freeze(r),e.set(r,"__testvalue__"),"__testvalue__"===e.get(r)}catch(e){return!1}}function x(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function j(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function L(e){if(!e)return"<unknown error: "+Object.prototype.toString.call(e)+">";if("string"==typeof e)return e;if(e instanceof Error){var r=e&&e.stack,t=e&&e.message;if(r&&t)return-1!==r.indexOf(t)?r:t+"\n"+r;if(r)return r;if(t)return t}return"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e)}function I(){}function D(e,r,t){return e.addEventListener?e.addEventListener(r,t):e.attachEvent("on"+r,t),{cancel:function(){e.removeEventListener?e.removeEventListener(r,t):e.detachEvent("on"+r,t)}}}function C(){var e="0123456789abcdef";return"xxxxxxxxxx".replace(/./g,function(){return e.charAt(Math.floor(Math.random()*e.length))})}function W(e,r){for(var t=0;t<e.length;t++)r(e[t],t)}function M(e,r){for(var t in e)e.hasOwnProperty(t)&&r(e[t],t)}function N(e,r){Array.isArray(e)?W(e,r):"object"===(void 0===e?"undefined":gr(e))&&null!==e&&M(e,r)}function G(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t>=100)throw new Error("Self-referential object passed, or object contained too many layers");var n=void 0;if("object"!==(void 0===e?"undefined":gr(e))||null===e||Array.isArray(e)){if(!Array.isArray(e))throw new Error("Invalid type: "+(void 0===e?"undefined":gr(e)));n=[]}else n={};return N(e,function(e,o){var i=r(e,o);void 0!==i?n[o]=i:"object"===(void 0===e?"undefined":gr(e))&&null!==e?n[o]=G(e,r,t+1):n[o]=e}),n}function q(e,r){function t(){n=setTimeout(t,r),e.call()}var n=void 0;return n=setTimeout(t,r),{cancel:function(){clearTimeout(n)}}}function Y(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function U(){return O()?vr.WINDOW_TYPES.POPUP:A()?vr.WINDOW_TYPES.IFRAME:vr.WINDOW_TYPES.FULLPAGE}function H(e,r,t){var n=void 0,o=void 0;try{if("{}"!==JSON.stringify({})&&(n=Object.prototype.toJSON,delete Object.prototype.toJSON),"{}"!==JSON.stringify({}))throw new Error("Can not correctly serialize JSON objects");if("[]"!==JSON.stringify([])&&(o=Array.prototype.toJSON,delete Array.prototype.toJSON),"[]"!==JSON.stringify([]))throw new Error("Can not correctly serialize JSON objects")}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}var i=JSON.stringify.call(this,e,r,t);try{n&&(Object.prototype.toJSON=n),o&&(Array.prototype.toJSON=o)}catch(e){throw new Error("Can not repair JSON.stringify: "+e.message)}return i}function B(e){return JSON.parse(e)}function F(e,r){return"object"===(void 0===e?"undefined":Tr(e))&&null!==e&&e.__type__===r}function J(e,r,t,n){var o=C(),i=Pr.methods.get(e);return i||(i={},Pr.methods.set(e,i)),i[o]={domain:r,method:t},{__type__:vr.SERIALIZATION_TYPES.METHOD,__id__:o,__name__:n}}function K(e){return{__type__:vr.SERIALIZATION_TYPES.ERROR,__message__:L(e)}}function Z(e,r,t,n){return{__type__:vr.SERIALIZATION_TYPES.PROMISE,__then__:J(e,r,function(e,r){return t.then(e,r)},n+".then")}}function z(e,r,t,n){return{__type__:vr.SERIALIZATION_TYPES.ZALGO_PROMISE,__then__:J(e,r,function(e,r){return t.then(e,r)},n+".then")}}function X(e){return{__type__:vr.SERIALIZATION_TYPES.REGEX,__source__:e.source}}function Q(e,r,t){return G({obj:t},function(t,n){return"function"==typeof t?J(e,r,t,n.toString()):t instanceof Error?K(t):window.Promise&&t instanceof window.Promise?Z(e,r,t,n.toString()):fr.isPromise(t)?z(e,r,t,n.toString()):Y(t)?X(t):void 0}).obj}function V(e,r,t){function n(){var n=Array.prototype.slice.call(arguments);return Ar.debug("Call foreign method",t.__name__,n),ge(e,vr.POST_MESSAGE_NAMES.METHOD,{id:t.__id__,name:t.__name__,args:n},{domain:r,timeout:1/0}).then(function(e){var r=e.data;return Ar.debug("Got foreign method result",t.__name__,r.result),r.result},function(e){throw Ar.debug("Got foreign method error",L(e)),e})}return n.__name__=t.__name__,n.__xdomain__=!0,n.source=e,n.origin=r,n}function $(e,r,t){return new Error(t.__message__)}function ee(e,r,t){return new fr(function(n,o){return V(e,r,t.__then__)(n,o)})}function re(e,r,t){return window.Promise?new window.Promise(function(n,o){return V(e,r,t.__then__)(n,o)}):ee(e,r,t)}function te(e,r,t){return new RegExp(t.__source__)}function ne(e,r,t){return G({obj:t},function(t,n){if("object"===(void 0===t?"undefined":Tr(t))&&null!==t)return F(t,vr.SERIALIZATION_TYPES.METHOD)?V(e,r,t):F(t,vr.SERIALIZATION_TYPES.ERROR)?$(e,r,t):F(t,vr.SERIALIZATION_TYPES.PROMISE)?re(e,r,t):F(t,vr.SERIALIZATION_TYPES.ZALGO_PROMISE)?ee(e,r,t):F(t,vr.SERIALIZATION_TYPES.REGEX)?te(e,r,t):void 0}).obj}function oe(){Ae(vr.POST_MESSAGE_NAMES.READY,{window:vr.WILDCARD,domain:vr.WILDCARD},function(e){var r=e.source,t=Pr.readyPromises.get(r);t?t.resolve(e):(t=(new fr).resolve(e),Pr.readyPromises.set(r,t))});var e=_();e&&ge(e,vr.POST_MESSAGE_NAMES.READY,{},{domain:vr.WILDCARD,timeout:1/0}).catch(function(e){Ar.debug(L(e))})}function ie(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Window",n=Pr.readyPromises.get(e);return n||(n=new fr,Pr.readyPromises.set(e,n),setTimeout(function(){return n.reject(new Error(t+" did not load after "+r+"ms"))},r),n)}function ae(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function ue(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=C(),o=U(),i=c(window);return xr({},r,t,{sourceDomain:i,id:r.id||n,windowType:o})}function se(e,r,t){return fr.try(function(){r=ue(e,r,{data:Q(e,t,r.data),domain:t});var n=void 0;if(n=-1!==Er.indexOf(r.name)||r.type===vr.POST_MESSAGE_TYPE.ACK?"debug":"error"===r.ack?"error":"info",Ar.logLevel(n,["\n\n\t","#send",r.type.replace(/^postrobot_message_/,""),"::",r.name,"::",t||vr.WILDCARD,"\n\n",r]),e===window)throw new Error("Attemping to send message to self");if(g(e))throw new Error("Window is closed");Ar.debug("Running send message strategies",r);var o=[],i=H(ae({},vr.WINDOW_PROPS.POSTROBOT,r),null,2);return fr.map(Object.keys(kr),function(r){return fr.try(function(){if(!Sr.ALLOWED_POST_MESSAGE_METHODS[r])throw new Error("Strategy disallowed: "+r);return kr[r](e,i,t)}).then(function(){return o.push(r+": success"),!0},function(e){return o.push(r+": "+L(e)+"\n"),!1})}).then(function(e){var t=e.some(Boolean),n=r.type+" "+r.name+" "+(t?"success":"error")+":\n  - "+o.join("\n  - ")+"\n";if(Ar.debug(n),!t)throw new Error(n)})})}function ce(e,r){Pr.responseListeners[e]=r}function fe(e){return Pr.responseListeners[e]}function le(e){delete Pr.responseListeners[e]}function de(e){var r=e.name,t=e.win,n=e.domain;if(t===vr.WILDCARD&&(t=null),n===vr.WILDCARD&&(n=null),!r)throw new Error("Name required to get request listener");var o=Pr.requestListeners[r];if(o)for(var i=[t,Pr.WINDOW_WILDCARD],a=0;a<i.length;a++){var u=i[a],s=u&&o.get(u);if(s){for(var c=[n,vr.WILDCARD],f=0;f<c.length;f++){var l=c[f];if(l&&(l=l.toString(),s[l]))return s[l]}if(s[Lr])for(var d=s[Lr],h=Array.isArray(d),p=0,d=h?d:d[Symbol.iterator]();;){var w;if(h){if(p>=d.length)break;w=d[p++]}else{if(p=d.next(),p.done)break;w=p.value}var y=w,m=y.regex,v=y.listener;if(P(m,n))return v}}}}function he(e,r){var t=e.name,n=e.win,o=e.domain;if(!t||"string"!=typeof t)throw new Error("Name required to add request listener");if(Array.isArray(n)){for(var i=[],a=n,u=Array.isArray(a),s=0,a=u?a:a[Symbol.iterator]();;){var c;if(u){if(s>=a.length)break;c=a[s++]}else{if(s=a.next(),s.done)break;c=s.value}var f=c;i.push(he({name:t,domain:o,win:f},r))}return{cancel:function(){for(var e=i,r=Array.isArray(e),t=0,e=r?e:e[Symbol.iterator]();;){var n;if(r){if(t>=e.length)break;n=e[t++]}else{if(t=e.next(),t.done)break;n=t.value}n.cancel()}}}}if(Array.isArray(o)){for(var l=[],d=o,h=Array.isArray(d),p=0,d=h?d:d[Symbol.iterator]();;){var w;if(h){if(p>=d.length)break;w=d[p++]}else{if(p=d.next(),p.done)break;w=p.value}var y=w;l.push(he({name:t,win:n,domain:y},r))}return{cancel:function(){for(var e=l,r=Array.isArray(e),t=0,e=r?e:e[Symbol.iterator]();;){var n;if(r){if(t>=e.length)break;n=e[t++]}else{if(t=e.next(),t.done)break;n=t.value}n.cancel()}}}}var m=de({name:t,win:n,domain:o});if(n&&n!==vr.WILDCARD||(n=Pr.WINDOW_WILDCARD),o=o||vr.WILDCARD,m)throw n&&o?new Error("Request listener already exists for "+t+" on domain "+o.toString()+" for specified window"):n?new Error("Request listener already exists for "+t+" for specified window"):o?new Error("Request listener already exists for "+t+" on domain "+o.toString()):new Error("Request listener already exists for "+t);var v=Pr.requestListeners,E=v[t];E||(E=new mr,v[t]=E);var S=E.get(n);S||(S={},E.set(n,S));var g=o.toString();S[g]=r;var _=S[Lr],b=void 0;return Y(o)&&(_||(_=[],S[Lr]=_),b={regex:o,listener:r},_.push(b)),{cancel:function(){S&&(delete S[g],n&&0===Object.keys(S).length&&E.delete(n),b&&_.splice(_.indexOf(b,1)))}}}function pe(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function we(e){var r=void 0;try{r=B(e)}catch(e){return}if(r&&"object"===(void 0===r?"undefined":Cr(r))&&null!==r&&(r=r[vr.WINDOW_PROPS.POSTROBOT])&&"object"===(void 0===r?"undefined":Cr(r))&&null!==r&&r.type&&"string"==typeof r.type&&Dr[r.type])return r}function ye(e){if(!window||window.closed)throw new Error("Message recieved in closed window");try{if(!e.source)return}catch(e){return}var r=e.source,t=e.origin,n=e.data,o=we(n);if(o){if(!o.sourceDomain||"string"!=typeof o.sourceDomain)throw new Error("Expected message to have sourceDomain");if(0!==o.sourceDomain.indexOf(vr.MOCK_PROTOCOL)&&0!==o.sourceDomain.indexOf(vr.FILE_PROTOCOL)||(t=o.sourceDomain),-1===Pr.receivedMessages.indexOf(o.id)){Pr.receivedMessages.push(o.id);var i=void 0;if(i=-1!==Er.indexOf(o.name)||o.type===vr.POST_MESSAGE_TYPE.ACK?"debug":"error"===o.ack?"error":"info",Ar.logLevel(i,["\n\n\t","#receive",o.type.replace(/^postrobot_message_/,""),"::",o.name,"::",t,"\n\n",o]),g(r))return void Ar.debug("Source window is closed - can not send "+o.type+" "+o.name);o.data&&(o.data=ne(r,t,o.data)),Dr[o.type](r,t,o)}}}function me(e){try{e.source}catch(e){return}var r={source:e.source||e.sourceElement,origin:e.origin||e.originalEvent&&e.originalEvent.origin,data:e.data};ye(r)}function ve(){D(window,"message",me)}function Ee(e){var r=Pr.requestPromises.get(e);if(r)for(var t=r,n=Array.isArray(t),o=0,t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if(o=t.next(),o.done)break;i=o.value}var a=i;a.reject(new Error("No response from window - cleaned up"))}Pr.popupWindowsByWin&&Pr.popupWindowsByWin.delete(e),Pr.remoteWindows&&Pr.remoteWindows.delete(e),Pr.requestPromises.delete(e),Pr.methods.delete(e),Pr.readyPromises.delete(e)}function Se(e){return fr.try(function(){if(!e.name)throw new Error("Expected options.name");var r=e.name,t=e.window,n=void 0;if("string"==typeof t){var o=document.getElementById(t);if(!o)throw new Error("Expected options.window "+Object.prototype.toString.call(t)+" to be a valid element id");if("iframe"!==o.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(t)+" to be an iframe");if(!o.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");t=o.contentWindow}else if(t instanceof HTMLElement){if("iframe"!==t.tagName.toLowerCase())throw new Error("Expected options.window "+Object.prototype.toString.call(t)+" to be an iframe");if(t&&!t.contentWindow)throw new Error("Iframe must have contentWindow.  Make sure it has a src attribute and is in the DOM.");t&&t.contentWindow&&(t=t.contentWindow)}if(!t)throw new Error("Expected options.window to be a window object, iframe, or iframe element id.");n=e.domain||vr.WILDCARD;var i=e.name+"_"+C();if(g(t))throw new Error("Target window is closed");var a=!1,u=Pr.requestPromises.get(t);u||(u=[],Pr.requestPromises.set(t,u));var s=fr.try(function(){if(b(window,t))return fr.resolve(ie(t))}).then(function(){return new fr(function(o,c){var f={name:r,window:t,domain:n,respond:function(e,r){e||(a=!0,u.splice(u.indexOf(s,1))),e?c(e):o(r)}};if(ce(i,f),se(t,{type:vr.POST_MESSAGE_TYPE.REQUEST,hash:i,name:r,data:e.data,fireAndForget:e.fireAndForget},n).catch(c),e.fireAndForget)return o();var l=Sr.ACK_TIMEOUT,d=e.timeout||Sr.RES_TIMEOUT,h=100,p=function n(){if(!a){if(g(t))return c(f.ack?new Error("Window closed for "+r+" before response"):new Error("Window closed for "+r+" before ack"));l-=h,d-=h;if(f.ack){if(d===1/0)return;h=Math.min(d,2e3)}else{if(l<=0)return c(new Error("No ack for postMessage "+r+" in "+Sr.ACK_TIMEOUT+"ms"));if(d<=0)return c(new Error("No response for postMessage "+r+" in "+(e.timeout||Sr.RES_TIMEOUT)+"ms"))}setTimeout(n,h)}};setTimeout(p,h)})});return s.catch(function(){le(i)}),u.push(s),s})}function ge(e,r,t,n){return n=n||{},n.window=e,n.name=r,n.data=t,Se(n)}function _e(e,r,t){var n=_();return n?ge(n,e,r,t):new fr(function(e,r){return r(new Error("Window does not have a parent"))})}function be(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.window)throw new Error("Expected options.window");return{send:function(r,t){return ge(e.window,r,t,e)}}}function Oe(e){if(!e.name)throw new Error("Expected options.name");if(!e.handler)throw new Error("Expected options.handler");var r={handler:e.handler,handleError:e.errorHandler||function(e){throw e},window:e.window,domain:e.domain||vr.WILDCARD,name:e.name},t=he({name:r.name,win:r.window,domain:r.domain},r);if(e.once){var n=r.handler;r.handler=_r(function(){return t.cancel(),n.apply(this,arguments)})}if(r.window&&e.errorOnClose)var o=q(function(){g(r.window)&&(o.cancel(),r.handleError(new Error("Post message target window is closed")))},50);return{cancel:function(){t.cancel()}}}function Ae(e,r,t){return"function"==typeof r&&(t=r,r={}),r=r||{},r.name=e,r.handler=t||r.handler,Oe(r)}function Pe(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments[2];"function"==typeof r&&(t=r,r={}),r=r||{},t=t||r.handler;var n=r.errorHandler,o=new fr(function(o,i){r=r||{},r.name=e,r.once=!0,r.handler=function(e){if(o(e),t)return t(e)},r.errorHandler=function(e){if(i(e),n)return n(e)}}),i=Oe(r);return o.cancel=i.cancel,o}function Te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{on:function(r,t){return Ae(r,e,t)}}}function Re(){delete window[vr.WINDOW_PROPS.POSTROBOT],window.removeEventListener("message",me)}function ke(){Pr.initialized||(ve(),oe(),Rr()),Pr.initialized=!0}function xe(e){var r={};if(!e)return r;for(var t=Array.from(e.keys()),n=Array.isArray(t),o=0,t=n?t:t[Symbol.iterator]();;){var i;if(n){if(o>=t.length)break;i=t[o++]}else{if(o=t.next(),o.done)break;i=o.value}var a=i;r[a.toLowerCase()]=e.get(a)}return r}function je(e){return new Headers(e||{})}function Le(e,r){var t={};if(!e)return t;for(var n=Object.keys(e),o=Array.isArray(n),i=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(i>=n.length)break;a=n[i++]}else{if(i=n.next(),i.done)break;a=i.value}var u=a;r(u)&&(t[u]=e[u])}return t}function Ie(e,r){return Le(e,function(e){return-1!==r.indexOf(e)})}function De(e,r){return Le(e,function(e){return r.test(e)})}function Ce(e,r){return Le(e,function(e){return e===r})}function We(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function Me(e){var r=Ie(e,Hr);return r.method&&(r.method=r.method.toLowerCase()),e&&e.headers&&(r.headers=xe(e.headers)),r}function Ne(e){return e.text().then(function(r){return new window.Response(r,{status:e.status,statusText:e.statusText,headers:je(e.headers)})})}function Ge(e,r){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return ge(e,Nr,{url:r,options:Me(t)}).then(function(e){return Ne(e.data)})}function qe(e){var r=T(e);if(!Br[r]){var t=document.createElement("iframe");t.style.display="none",t.setAttribute("src",e);var n=document.body||document.head;if(!n)throw new Error("Could not find suitable container for proxy iframe");n.appendChild(t),Br[r]=t}return Br[r]}function Ye(){for(var e=Object.keys(Br),r=Array.isArray(e),t=0,e=r?e:e[Symbol.iterator]();;){var n;if(r){if(t>=e.length)break;n=e[t++]}else{if(t=e.next(),t.done)break;n=t.value}var o=n,i=Br[o];i.parentNode.removeChild(i),delete Br[o]}}function Ue(e){var r=e.url,t=qe(r).contentWindow;return{fetch:function(e,r){return Ge(t,e,r)}}}function He(e,r){if("string"!=typeof r&&!(We(r)||Array.isArray(r)&&r.every(function(e){return"string"==typeof e})))throw new Error("Invalid matcher for "+e+": "+Object.prototype.toString.call(r))}function Be(e,r){if(r===Gr)return e;if(Array.isArray(r))return Ie(e,r);if(We(r))return De(e,r);if("string"==typeof r)return Ce(e,r);throw new Error("Invalid matcher")}function Fe(e){for(var r=e,t=Array.isArray(r),n=0,r=t?r:r[Symbol.iterator]();;){var o;if(t){if(n>=r.length)break;o=r[n++]}else{if(n=r.next(),n.done)break;o=n.value}for(var i=o,a=Object.keys(i),u=Array.isArray(a),s=0,a=u?a:a[Symbol.iterator]();;){var c;if(u){if(s>=a.length)break;c=a[s++]}else{if(s=a.next(),s.done)break;c=s.value}var f=c;if(!Kr.hasOwnProperty(f))throw new Error("Unexpected rule: "+f);He(f,i[f])}}}function Je(e){return Array.isArray(e)?0===e.length?"[]":"[ "+e.map(function(e){return"'"+e+"'"}).join(", ")+" ]":"'"+e+"'"}function Ke(e){return"string"==typeof e?"[ '"+e+"' ]":Array.isArray(e)?0===e.length?"[]":"[ "+e.map(function(e){return"'"+e+"'"}).join(", ")+" ]":We(e)?"/"+e.source+"/":e.toString()}function Ze(e,r){return Array.isArray(e)?e.every(function(e){return Ze(e,r)}):"string"==typeof r?r===Gr||e===r:We(r)?r.test(e):!!Array.isArray(r)&&r.some(function(r){return r===e})}function ze(e){var r=new Jr.a(e,window.mockDomain||window.location,!0);return{domain:r.protocol+"//"+r.host,path:r.pathname,query:r.query}}function Xe(e,r,t,n){for(var o=ze(r),i=o.domain,a=o.path,u=o.query,s=[],c=n,f=Array.isArray(c),l=0,c=f?c:c[Symbol.iterator]();;){var d;if(f){if(l>=c.length)break;d=c[l++]}else{if(l=c.next(),l.done)break;d=l.value}for(var h=d,p=[],w=[{name:"origin",value:e},{name:"domain",value:i},{name:"method",value:t.method||"get"},{name:"path",value:a},{name:"query",value:Object.keys(u)},{name:"headers",value:Object.keys(t.headers||{})},{name:"options",value:Object.keys(t)}],y=w,m=Array.isArray(y),v=0,y=m?y:y[Symbol.iterator]();;){var E;if(m){if(v>=y.length)break;E=y[v++]}else{if(v=y.next(),v.done)break;E=v.value}var S=E,g=S.name,_=S.value,b=h.hasOwnProperty(g)?h[g]:Kr[g];Ze(_,b)||p.push({name:g,value:_,matcher:b})}if(!p.length)return h;s.push(p)}var O=s.map(function(e){return e.map(function(e){var r=e.name,t=e.value,n=e.matcher;return"- "+r+" :: got "+Je(t)+" - expected "+Ke(n)}).join("\n")}).join("\n\n");throw new Error("Failed to find matching rule for request:\n\n"+O+"\n")}function Qe(e,r){return Be(e,r.responseHeaders||Kr.responseHeaders||[])}function Ve(e){var r=Ie(e,Hr);return e&&e.headers&&(r.headers=je(e.headers)),r}function $e(e){return{status:e.status,statusText:e.statusText,text:e.text.bind(e),headers:xe(e.headers)}}function er(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.allow,t=void 0===r?[]:r;0===t.length&&(t=[Kr]),Fe(t);var n=Ae(Nr,{},function(e){var r=e.origin,n=e.data,o=n.url,i=n.options,a=Xe(r,o,i,t);return window.fetch(o,Ve(i)).then(function(e){var r=$e(e);return r.headers=Qe(r.headers,a),r})});return Zr.push(n),{cancel:n.cancel}}function rr(){for(var e=Zr,r=Array.isArray(e),t=0,e=r?e:e[Symbol.iterator]();;){var n;if(r){if(t>=e.length)break;n=e[t++]}else{if(t=e.next(),t.done)break;n=t.value}n.cancel()}}function tr(){Ye(),rr()}Object.defineProperty(r,"__esModule",{value:!0});var nr={};t.d(nr,"WeakMap",function(){return mr});var or={};t.d(or,"cleanUpWindow",function(){return Ee}),t.d(or,"init",function(){return ke}),t.d(or,"Promise",function(){return fr}),t.d(or,"parent",function(){return Wr}),t.d(or,"bridge",function(){return Mr}),t.d(or,"send",function(){return ge}),t.d(or,"request",function(){return Se}),t.d(or,"sendToParent",function(){return _e}),t.d(or,"client",function(){return be}),t.d(or,"on",function(){return Ae}),t.d(or,"listen",function(){return Oe}),t.d(or,"once",function(){return Pe}),t.d(or,"listener",function(){return Te}),t.d(or,"CONFIG",function(){return Sr}),t.d(or,"CONSTANTS",function(){return vr}),t.d(or,"disable",function(){return Re});var ir,ar={}.toString,ur=[],sr=[],cr=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),fr=function(){function e(r){var t=this;if(a(this,e),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],r){var n=void 0,o=void 0,i=!1,u=!1,s=!1;try{r(function(e){s?t.resolve(e):(i=!0,n=e)},function(e){s?t.reject(e):(u=!0,o=e)})}catch(e){return void this.reject(e)}s=!0,i?this.resolve(n):u&&this.reject(o)}}return cr(e,[{key:"resolve",value:function(e){if(this.resolved||this.rejected)return this;if(n(e))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=e,this.dispatch(),this}},{key:"reject",value:function(e){var r=this;if(this.resolved||this.rejected)return this;if(n(e))throw new Error("Can not reject promise with another promise");if(!e){var t=e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e);e=new Error("Expected reject to be called with Error, got "+t)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout(function(){r.errorHandled||o(e)},1),this.dispatch(),this}},{key:"asyncReject",value:function(e){this.errorHandled=!0,this.reject(e)}},{key:"dispatch",value:function(){var r=this,t=this.dispatching,o=this.resolved,i=this.rejected,a=this.handlers;if(!t&&(o||i)){this.dispatching=!0;for(var u=0;u<a.length;u++){(function(t){var u=a[t],s=u.onSuccess,c=u.onError,f=u.promise,l=void 0;if(o)try{l=s?s(r.value):r.value}catch(e){return f.reject(e),"continue"}else if(i){if(!c)return f.reject(r.error),"continue";try{l=c(r.error)}catch(e){return f.reject(e),"continue"}}l instanceof e&&(l.resolved||l.rejected)?(l.resolved?f.resolve(l.value):f.reject(l.error),l.errorHandled=!0):n(l)?l instanceof e&&(l.resolved||l.rejected)?l.resolved?f.resolve(l.value):f.reject(l.error):l.then(function(e){f.resolve(e)},function(e){f.reject(e)}):f.resolve(l)})(u)}a.length=0,this.dispatching=!1}}},{key:"then",value:function(r,t){if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for success handler");if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.then expected a function for error handler");var n=new e;return this.handlers.push({promise:n,onSuccess:r,onError:t}),this.errorHandled=!0,this.dispatch(),n}},{key:"catch",value:function(e){return this.then(void 0,e)}},{key:"finally",value:function(r){return this.then(function(t){return e.try(r).then(function(){return t})},function(t){return e.try(r).then(function(){throw t})})}},{key:"timeout",value:function(e,r){var t=this;if(this.resolved||this.rejected)return this;var n=setTimeout(function(){t.resolved||t.rejected||t.reject(r||new Error("Promise timed out after "+e+"ms"))},e);return this.then(function(e){return clearTimeout(n),e})}},{key:"toPromise",value:function(){if(!window.Promise)throw new Error("Could not find window.Promise");return window.Promise.resolve(this)}}],[{key:"resolve",value:function(r){return r instanceof e?r:n(r)?new e(function(e,t){return r.then(e,t)}):(new e).resolve(r)}},{key:"reject",value:function(r){return(new e).reject(r)}},{key:"all",value:function(r){var t=new e,n=r.length,o=[];if(!n)return t.resolve(o),t;for(var i=0;i<r.length;i++)!function(i){e.resolve(r[i]).then(function(e){o[i]=e,0===(n-=1)&&t.resolve(o)},function(e){t.reject(e)})}(i);return t}},{key:"map",value:function(r,t){var n=new e,o=r.length,i=[];if(!o)return n.resolve(i),n;for(var a=0;a<r.length;a++)!function(a){e.try(function(){return t(r[a])}).then(function(e){i[a]=e,0===(o-=1)&&n.resolve(i)},function(e){n.reject(e)})}(a);return n}},{key:"onPossiblyUnhandledException",value:function(e){return i(e)}},{key:"try",value:function(r,t,n){var o=void 0;try{o=r.apply(t,n||[])}catch(r){return e.reject(r)}return e.resolve(o)}},{key:"delay",value:function(r){return new e(function(e){setTimeout(e,r)})}},{key:"hash",value:function(r){var t={},n=[];for(var o in r)!function(o){r.hasOwnProperty(o)&&n.push(e.resolve(r[o]).then(function(e){t[o]=e}))}(o);return e.all(n).then(function(){return t})}},{key:"isPromise",value:function(r){return!!(r&&r instanceof e)||n(r)}}]),e}(),lr={MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",WILDCARD:"*"},dr=[],hr=[],pr=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),wr=Object.defineProperty,yr=Date.now()%1e9,mr=function(){function e(){if(x(this,e),yr+=1,this.name="__weakmap_"+(1e9*Math.random()>>>0)+"__"+yr,k())try{this.weakmap=new window.WeakMap}catch(e){}this.keys=[],this.values=[]}return pr(e,[{key:"_cleanupClosedWindows",value:function(){for(var e=this.weakmap,r=this.keys,t=0;t<r.length;t++){var n=r[t];if(g(n)){if(e)try{e.delete(n)}catch(e){}r.splice(t,1),this.values.splice(t,1),t-=1}}}},{key:"isSafeToReadWrite",value:function(e){if(R(e))return!1;try{e&&e.self,e&&e[this.name]}catch(e){return!1}return!0}},{key:"set",value:function(e,r){if(!e)throw new Error("WeakMap expected key");var t=this.weakmap;if(t)try{t.set(e,r)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var n=this.name,o=e[n];o&&o[0]===e?o[1]=r:wr(e,n,{value:[e,r],writable:!0})}else{this._cleanupClosedWindows();var i=this.keys,a=this.values,u=i.indexOf(e);-1===u?(i.push(e),a.push(r)):a[u]=r}}},{key:"get",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{if(r.has(e))return r.get(e)}catch(e){delete this.weakmap}if(!this.isSafeToReadWrite(e)){this._cleanupClosedWindows();var t=this.keys,n=t.indexOf(e);if(-1===n)return;return this.values[n]}var o=e[this.name];if(o&&o[0]===e)return o[1]}},{key:"delete",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{r.delete(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var t=e[this.name];t&&t[0]===e&&(t[0]=t[1]=void 0)}else{this._cleanupClosedWindows();var n=this.keys,o=n.indexOf(e);-1!==o&&(n.splice(o,1),this.values.splice(o,1))}}},{key:"has",value:function(e){if(!e)throw new Error("WeakMap expected key");var r=this.weakmap;if(r)try{return r.has(e)}catch(e){delete this.weakmap}if(this.isSafeToReadWrite(e)){var t=e[this.name];return!(!t||t[0]!==e)}return this._cleanupClosedWindows(),-1!==this.keys.indexOf(e)}}]),e}(),vr={POST_MESSAGE_TYPE:{REQUEST:"postrobot_message_request",RESPONSE:"postrobot_message_response",ACK:"postrobot_message_ack"},POST_MESSAGE_ACK:{SUCCESS:"success",ERROR:"error"},POST_MESSAGE_NAMES:{METHOD:"postrobot_method",READY:"postrobot_ready",OPEN_TUNNEL:"postrobot_open_tunnel"},WINDOW_TYPES:{FULLPAGE:"fullpage",POPUP:"popup",IFRAME:"iframe"},WINDOW_PROPS:{POSTROBOT:"__postRobot__"},SERIALIZATION_TYPES:{METHOD:"postrobot_method",ERROR:"postrobot_error",PROMISE:"postrobot_promise",ZALGO_PROMISE:"postrobot_zalgo_promise",REGEX:"regex"},SEND_STRATEGIES:{POST_MESSAGE:"postrobot_post_message",BRIDGE:"postrobot_bridge",GLOBAL:"postrobot_global"},MOCK_PROTOCOL:"mock:",FILE_PROTOCOL:"file:",BRIDGE_NAME_PREFIX:"__postrobot_bridge__",POSTROBOT_PROXY:"__postrobot_proxy__",WILDCARD:"*"},Er=Object.keys(vr.POST_MESSAGE_NAMES).map(function(e){return vr.POST_MESSAGE_NAMES[e]}),Sr={ALLOW_POSTMESSAGE_POPUP:!0,LOG_LEVEL:"info",BRIDGE_TIMEOUT:5e3,ACK_TIMEOUT:1e3,RES_TIMEOUT:1/0,LOG_TO_PAGE:!1,ALLOWED_POST_MESSAGE_METHODS:(ir={},j(ir,vr.SEND_STRATEGIES.POST_MESSAGE,!0),j(ir,vr.SEND_STRATEGIES.BRIDGE,!0),j(ir,vr.SEND_STRATEGIES.GLOBAL,!0),ir)};0===window.location.href.indexOf(vr.FILE_PROTOCOL)&&(Sr.ALLOW_POSTMESSAGE_POPUP=!0);var gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_r=function(e){if(!e)return e;var r=!1;return function(){if(!r)return r=!0,e.apply(this,arguments)}},br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or=["debug","info","warn","error"];Function.prototype.bind&&window.console&&"object"===br(console.log)&&["log","info","warn","error"].forEach(function(e){console[e]=this.bind(console[e],console)},Function.prototype.call);var Ar={clearLogs:function(){if(window.console&&window.console.clear&&window.console.clear(),Sr.LOG_TO_PAGE){var e=document.getElementById("postRobotLogs");e&&e.parentNode&&e.parentNode.removeChild(e)}},writeToPage:function(e,r){setTimeout(function(){var t=document.getElementById("postRobotLogs");t||(t=document.createElement("div"),t.id="postRobotLogs",t.style.cssText="width: 800px; font-family: monospace; white-space: pre-wrap;",document.body&&document.body.appendChild(t));var n=document.createElement("div"),o=(new Date).toString().split(" ")[4],i=Array.prototype.slice.call(r).map(function(e){if("string"==typeof e)return e;if(!e)return Object.prototype.toString.call(e);var r=void 0;try{r=H(e,null,2)}catch(e){r="[object]"}return"\n\n"+r+"\n\n"}).join(" "),a=o+" "+e+" "+i;n.innerHTML=a;var u={log:"#ddd",warn:"orange",error:"red",info:"blue",debug:"#aaa"}[e];n.style.cssText="margin-top: 10px; color: "+u+";",t.childNodes.length?t.insertBefore(n,t.childNodes[0]):t.appendChild(n)})},logLevel:function(e,r){setTimeout(function(){try{var t=window.LOG_LEVEL||Sr.LOG_LEVEL;if(Or.indexOf(e)<Or.indexOf(t))return;if(r=Array.prototype.slice.call(r),r.unshift(""+window.location.host+window.location.pathname),r.unshift("::"),r.unshift(""+U().toLowerCase()),r.unshift("[post-robot]"),Sr.LOG_TO_PAGE&&Ar.writeToPage(e,r),!window.console)return;if(window.console[e]||(e="log"),!window.console[e])return;window.console[e].apply(window.console,r)}catch(e){}},1)},debug:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];Ar.logLevel("debug",r)},info:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];Ar.logLevel("info",r)},warn:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];Ar.logLevel("warn",r)},error:function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];Ar.logLevel("error",r)}},Pr=window[vr.WINDOW_PROPS.POSTROBOT]=window[vr.WINDOW_PROPS.POSTROBOT]||{};Pr.registerSelf=function(){};var Tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Pr.methods=Pr.methods||new mr;var Rr=_r(function(){Ae(vr.POST_MESSAGE_NAMES.METHOD,{window:vr.WILDCARD,origin:vr.WILDCARD},function(e){var r=e.source,t=e.origin,n=e.data,o=Pr.methods.get(r);if(!o)throw new Error("Could not find any methods this window has privileges to call");var i=o[n.id];if(!i)throw new Error("Could not find method with id: "+n.id);if(!P(i.domain,t))throw new Error("Method domain "+i.domain+" does not match origin "+t);return Ar.debug("Call local method",n.name,n.args),fr.try(function(){return i.method.apply({source:r,origin:t,data:n},n.args)}).then(function(e){return{result:e,id:n.id,name:n.name}})})});Pr.readyPromises=Pr.readyPromises||new mr;var kr={};kr[vr.SEND_STRATEGIES.POST_MESSAGE]=function(e,r,t){var n=void 0;n=Array.isArray(t)?t:t?[t]:[vr.WILDCARD],n=n.map(function(r){if(0===r.indexOf(vr.MOCK_PROTOCOL)){if(window.location.protocol===vr.FILE_PROTOCOL)return vr.WILDCARD;if(!l(e))throw new Error("Attempting to send messsage to mock domain "+r+", but window is actually cross-domain");return s(e)}return 0===r.indexOf(vr.FILE_PROTOCOL)?vr.WILDCARD:r}),n.forEach(function(t){return e.postMessage(r,t)})};var xr=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e};Pr.responseListeners=Pr.responseListeners||{},Pr.requestListeners=Pr.requestListeners||{},Pr.WINDOW_WILDCARD=Pr.WINDOW_WILDCARD||new function(){};var jr,Lr="__domain_regex__",Ir=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},Dr=(jr={},pe(jr,vr.POST_MESSAGE_TYPE.ACK,function(e,r,t){var n=fe(t.hash);if(!n)throw new Error("No handler found for post message ack for message: "+t.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!P(n.domain,r))throw new Error("Ack origin "+r+" does not match domain "+n.domain.toString());n.ack=!0}),pe(jr,vr.POST_MESSAGE_TYPE.REQUEST,function(e,r,t){function n(n){return t.fireAndForget||g(e)?fr.resolve():se(e,Ir({target:t.originalSource,hash:t.hash,name:t.name},n),r)}var o=de({name:t.name,win:e,domain:r});return fr.all([n({type:vr.POST_MESSAGE_TYPE.ACK}),fr.try(function(){if(!o)throw new Error("No handler found for post message: "+t.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!P(o.domain,r))throw new Error("Request origin "+r+" does not match domain "+o.domain.toString());var n=t.data;return o.handler({source:e,origin:r,data:n})}).then(function(e){return n({type:vr.POST_MESSAGE_TYPE.RESPONSE,ack:vr.POST_MESSAGE_ACK.SUCCESS,data:e})},function(e){var r=L(e).replace(/^Error: /,"");return n({type:vr.POST_MESSAGE_TYPE.RESPONSE,ack:vr.POST_MESSAGE_ACK.ERROR,error:r})})]).then(I).catch(function(e){if(o&&o.handleError)return o.handleError(e);Ar.error(L(e))})}),pe(jr,vr.POST_MESSAGE_TYPE.RESPONSE,function(e,r,t){var n=fe(t.hash);if(!n)throw new Error("No handler found for post message response for message: "+t.name+" from "+r+" in "+window.location.protocol+"//"+window.location.host+window.location.pathname);if(!P(n.domain,r))throw new Error("Response origin "+r+" does not match domain "+n.domain);if(le(t.hash),t.ack===vr.POST_MESSAGE_ACK.ERROR)return n.respond(new Error(t.error),null);if(t.ack===vr.POST_MESSAGE_ACK.SUCCESS){var o=t.data||t.response;return n.respond(null,{source:e,origin:r,data:o})}}),jr),Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Pr.receivedMessages=Pr.receivedMessages||[],Pr.requestPromises=Pr.requestPromises||new mr;var Wr=_(),Mr=void 0;ke();var Nr="fetch-robot-proxy",Gr="*",qr=["get","head","post","put","delete","connect","options","trace","patch"],Yr=["accept","accept-language","content-language","content-type"],Ur=["cache-control","content-language","content-type","expires","last-modified","pragma"],Hr=["method","body","mode","credentials","cache","redirect","referrer","integrity","headers"],Br={},Fr=t("./node_modules/url-parse/index.js"),Jr=t.n(Fr),Kr={origin:Gr,domain:c(),path:[],query:Gr,method:qr,headers:Yr,options:Hr,responseHeaders:Ur},Zr=[];t.d(r,"connect",function(){return Ue}),t.d(r,"serve",function(){return er}),t.d(r,"destroyAll",function(){return tr}),t.d(r,"WILDCARD",function(){return Gr}),t.d(r,"STANDARD_REQUEST_HEADERS",function(){return Yr}),t.d(r,"STANDARD_RESPONSE_HEADERS",function(){return Ur})}})});
//# sourceMappingURL=fetch-robot.min.js.map
//# sourceMappingURL=fetch-robot.min.js.map